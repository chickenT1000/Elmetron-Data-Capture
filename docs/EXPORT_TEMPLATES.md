# Export Templates Guide

The reporting CLI ships with ready-to-use templates stored under `config/templates/`. The defaults referenced by `config/app.toml` are:

- `session_report.fmt` → text layout used when exporting PDF summaries.
- `session_lims.xml.fmt` → XML payload suitable for importing into LIMS tools.

Both templates rely on Python `.format` placeholders; missing keys resolve to empty strings, so unused fields simply collapse.

## Customising Templates
1. Copy the existing template and adjust it in-place or save it under a new name beside the originals.
2. Update either `export.pdf_template` or `export.lims_template` in `config/app.toml` (or pass `--pdf-template/--lims-template`) to point at the new file.
3. Re-run `python -m elmetron.reporting.exporters export-session ...` to verify the output. When the LIMS template is changed, the exporter validates the rendered XML before writing it to disk.

Each export call flattens the template context:

- Top-level metadata such as `{session_id}`, `{generated_at}`, `{summary_measurements}`.
- Instrument details via `{summary_instrument_description}`, `{summary_instrument_serial}`, `{summary_instrument_model}`.
- Operator annotations via `{summary_metadata_operator}` and other custom metadata keys.
- Recent measurement values fetched from the capture stream, e.g. `{recent_measurements_0_value}`, `{recent_measurements_0_unit}`, `{recent_measurements_0_temperature}`.
- Convenience lines generated by the built-in report pipeline: `{default_lines_0}` … `{default_lines_4}` mirror the default summary text.

If more than one recent measurement is required, increment the index (e.g. `{recent_measurements_1_value}`). Arrays also expose `{recent_measurements_count}` for quick checks.

> Tip: use `python -m elmetron.reporting.exporters export-session ... --json` to inspect the raw records and confirm which fields are available before editing the templates.
